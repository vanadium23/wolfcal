#!/bin/bash
# Helper script to create tasks for fn-9-e2e epic

echo "Creating tasks for E2E smoke test suite epic..."
echo ""
echo "Task breakdown:"
echo ""
echo "fn-9-e2e.1: Create MSW browser worker setup for Playwright"
echo "  - Create src/test/mocks/browser.ts with setupWorker from msw/browser"
echo "  - Export worker instance and start/stop functions"
echo "  - Reuse existing handlers from src/test/mocks/handlers.ts"
echo ""
echo "fn-9-e2e.2: Create Playwright test fixtures and helpers"
echo "  - Create src/test/e2e/fixtures/ directory"
echo "  - Create accounts.ts - mock account helpers for IndexedDB"
echo "  - Create indexeddb.ts - IndexedDB manipulation utilities"
echo "  - Create oauth.ts - OAuth flow mock helpers"
echo ""
echo "fn-9-e2e.3: Configure Playwright for MSW integration"
echo "  - Create src/test/e2e-setup.ts"
echo "  - Update playwright.config.ts with setupFiles reference"
echo "  - Add MSW worker injection via page.addInitScript()"
echo ""
echo "fn-9-e2e.4: Write OAuth flow E2E test"
echo "  - Create src/test/e2e/oauth.spec.ts"
echo "  - Test: Navigate to Settings, click Add Account, mock OAuth popup"
echo "  - Verify: Token storage in IndexedDB, account appears in list"
echo "  - Test: Error handling for failed OAuth"
echo ""
echo "fn-9-e2e.5: Write calendar sync E2E test"
echo "  - Create src/test/e2e/sync.spec.ts"
echo "  - Test: Pre-populate account, trigger sync, verify API interception"
echo "  - Verify: Events stored in IndexedDB, sync metadata updated"
echo "  - Test: Sync error handling with MSW error responses"
echo ""
echo "fn-9-e2e.6: Write calendar view E2E test"
echo "  - Create src/test/e2e/calendar-view.spec.ts"
echo "  - Test: Pre-populate events, verify FullCalendar rendering"
echo "  - Test: View switching (month/week/day), event clicking"
echo "  - Test: Date navigation, event display with correct styling"
echo ""
echo "fn-9-e2e.7: Validate offline functionality (strict requirement)"
echo "  - Run all E2E tests with network simulation disabled"
echo "  - Verify zero real network requests to googleapis.com"
echo "  - Document offline test execution in README"
echo ""
echo "To create these tasks, use flowctl:"
echo "  .flow/bin/flowctl plan --epic fn-9-e2e"
echo ""
echo "Or create individual tasks with:"
echo "  .flow/bin/flowctl add --epic fn-9-e2e '<task title>'"
